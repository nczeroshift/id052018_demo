<html>
    <head>
        <script type="text/javascript" src="jquery.min.js"></script>
        <script type="text/javascript" src="scenes/utils.js"></script>
        <script type="text/javascript" src="three.min.js"></script>
        <script type="text/javascript" src="scenes/demo.js"></script>
        <script type="text/javascript" src="scenes/scene.js"></script>
        <script type="text/javascript" src="scenes/scene_color.js"></script>
        <script type="text/javascript" src="scenes/scene_amiga.js"></script>
        <script type="text/javascript" src="scenes/scene_dont_forget.js"></script>
        <script type="text/javascript" src="scenes/scene_shader.js"></script>
        <script type="text/javascript" src="scenes/scene_text.js"></script>
        <script type="text/javascript" src="scenes/scene_pic.js"></script>

        <style type="text/css">
            body{
                background-color:#000;
                padding:0;
                margin:0;
            }

            canvas{
                position:relative;
                width: 100%; 
                height: 100%;
            }

            #aplayer{
                position:absolute;
                top:0;
                left:0;
                opacity:0.001;
            }

            #run{
                position:absolute;
                top:50%;
                left:50%;
                width:100px;
                height:30px;
                border:1px solid #FFFFFF;
                background-color:#FFFFFF;
                margin-left:-50px;
            }
        </style>
        
    </head>
    <body>
        <canvas width="100%" height="100%"></canvas>
        <button id="run">Run</button>
        <audio controls id="aplayer">
            <source src="audio/megademo1.ogg" type="audio/ogg">
        </audio>
		<!--<div id="timer" style="z-index:30; position: absolute; top: 0px; left: 0px; color: white;">banana</div>-->
    </body>
    <script type="text/javascript">
    
        function run(){
            var canvas = $("canvas");
            var demo = new Demo(canvas);

            demo.init(function(d){
                var c1 = new SceneColor(d, new THREE.Color(0x000000),new THREE.Color(0x000000), 1, 1);
                d.addScene(c1, 0, 1000);

                {
                    var l1 = new SceneColor(d, new THREE.Color(0x000000), new THREE.Color(0x000000), 1, 0);
                    l1.setOrder(2);
                    d.addScene(l1, 0, 7);

                    var text1 = new SceneText(d,"the\nportuguese\ndemoscene party", 25);
                    text1.setPosition(function(m,t){
                        m.position.x = -t*10 - 200;
                        m.position.y = 50;
                    });
                    text1.setOrder(1);
                    d.addScene(text1, 0, 14);
                
                    var l2 = new SceneColor(d, new THREE.Color(0x000000), new THREE.Color(0x000000), 0, 1);
                    l2.setOrder(2);
                    d.addScene(l2, 7, 14);

                    var pic1 = new ScenePicture(d,"textures/id_logo.png", 40, 40);
                    pic1.setPosition(function(m,t){
                        m.position.x = t+10;
                    });
                    d.addScene(pic1, 0, 14);
                }

                var e2 = new SceneShader(d,"effect1");
                d.addScene(e2, 14, 19);

                var l2 = new SceneColor(d, new THREE.Color(0x000000), new THREE.Color(0x000000), 1, 0);
                l2.setOrder(100);
                d.addScene(l2, 14, 15);

                var amiga = new SceneAmiga(d);
                amiga.setOrder(50);
                d.addScene(amiga, 18, 43);

                var e2 = new SceneShader(d,"effect2");
                d.addScene(e2, 19, 22.5);
				
                var e2 = new SceneShader(d,"effect1");
                d.addScene(e2, 22.5, 25.5);

                var e2 = new SceneShader(d,"effect2");
                d.addScene(e2, 25.5, 29.5);
				
                var e2 = new SceneShader(d,"effect1");
                d.addScene(e2, 29.5, 32);
				
				var e2 = new SceneShader(d,"effect2");
                d.addScene(e2, 32, 35);
				
				var e2 = new SceneShader(d,"effect1");
                d.addScene(e2, 35, 36);
				
				var e2 = new SceneShader(d,"effect2");
                d.addScene(e2, 36, 43);
								
                var e3 = new SceneShader(d,"effect3");
                d.addScene(e3, 43, 54);

                var e4 = new SceneShader(d,"effect4");
                d.addScene(e4, 54, 64);

                var e5 = new SceneShader(d,"effect5");
                d.addScene(e5, 64, 74);

                var aspect = 4.0/3.0;

                var pic1 = new ScenePicture(d,"textures/belem_jeenio_truck.jpg",20 * aspect,20.0);
                pic1.setPosition(function(m,t){
                    t-=24;
                    m.position.x = t*5 +Math.cos(t)* 6 - 60;
                    m.position.y = 10 + Math.sin(t) * 5;
                    m.rotation.y = Math.cos(t)*0.5;
                });
                pic1.setOrder(100);
                d.addScene(pic1, 24, 50);

                var pic2 = new ScenePicture(d,"textures/aroeira_ps_jeenio_truck.jpg", 20 * aspect,20.0);
                pic2.setPosition(function(m,t){
                    t-= 34;
                    m.position.x = t*2 -10;
                    m.position.y = -10 + Math.abs(Math.sin(t))*5;
                });
                pic2.setOrder(100);
                d.addScene(pic2, 34,100);

                var pic3 = new ScenePicture(d,"textures/aroeira_jeenio_playing.jpg", 15 * aspect,15.0);
                pic3.setPosition(function(m,t){
                    t-= 40;
                    m.position.x = t*2 -20 +  Math.abs(Math.sin(t))*5;
                    m.position.y = 0;
                });
                pic3.setOrder(100);
                d.addScene(pic3, 40,54);

                var e6 = new SceneShader(d,"gears");
                d.addScene(e6, 74, 85);

                var l3 = new SceneColor(d, new THREE.Color(0x000000), new THREE.Color(0x000000), 0, 1);
                l3.setOrder(100);
                d.addScene(l3, 63, 64);

                var dontforget = new SceneDontForget(d);
                d.addScene(dontforget,85,100);
                
                d.launchReadyTimer(function(){
                    d.start();   
                    $("#aplayer")[0].play() 
                })
            });
        }

        $(function(){
            $("#run").click(function(){
                $("canvas").css({cursor:"none"});
                $(this).hide();
                run();
           });
        });
    </script>
</html>